#compdef note

_note() {
  _arguments -C \
    '1: :_note_cmds' \
    '*:: :->args'

  case $state in
    (args)
      case $words[1] in
        new)
          _arguments -C '1: :{_note-contexts}'
          ;;
        edit|find)
          _message 'no more arguments'
          ;;
      esac
  esac
}

_note_cmds() {
  local commands;
  commands=(
    'new:Create a new note'
    'edit:Edit existing notes'
    'find:Search for a note'
  )

  _describe -t commands 'note command' commands "$@"
}

_note-contexts() {
  local -a contexts
  contexts=($(ls "$NOTES"))
  _describe 'context' contexts
}
